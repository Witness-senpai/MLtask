from catboost import Pool
import pandas as pd

def dataframe_to_pool(df,
               numeric_columns,
               categorical_columns,
               target_column,
               ):
    columns = numeric_columns + categorical_columns
    target = None
    if target_column in df.columns:
        target = df[target_column]
    df = df[columns].copy()
    for col in categorical_columns:
        df[col] = df[col].cat.add_categories(-1)
        df.loc[:, col] = df[col].fillna(-1)
    return Pool(
            df,
            label=target,
            cat_features=categorical_columns,
        )


def json_to_pool(json_data,
            numeric_columns,
            categorical_columns,
            target_column
            ):
    df = pd.DataFrame(json_data, index=[0])
    return dataframe_to_pool(df,
                        numeric_columns,
                        categorical_columns,
                        target_column)
